import{m as h,v as F,i as ve,V as Ce,K as ge,U as xe,s as R,d as Se,I as Fe,aF as ke,N as Ve,C as Z,o as N,c as B,w as u,a as r,O as M,aG as J,ae as L,Q as A,E as $,e as he,ai as ue,af as H,aj as K,aC as E,aH as we,ah as le,ag as de}from"./index.97d5dc32.js";import{h as qe,e as ze,i as Ne,j as Qe,k as Ue,l as Ae,m as De,n as me,a as Q,b as W,Q as se}from"./QCard.f9f965bc.js";import{Q as Te,a as Ee,b as ce,c as fe,d as pe}from"./QTable.6f9469ac.js";import{P as Y}from"./post.504de866.js";import{Q as re}from"./QCardActions.43e7e106.js";import{l as ne}from"./QDialog.6dc8872f.js";import{Q as $e}from"./QImg.3224dc0f.js";import{Q as Ie}from"./QSeparator.f14b87d2.js";const Re=[{name:"id",align:"left",label:"ID",field:"id",sortable:!0},{name:"admin",align:"center",label:"User Name",field:"admin",sortable:!0,format:t=>t.name},{name:"title",align:"center",label:"Title",field:"title",sortable:!0},{name:"description",align:"center",label:"Description",field:"description",sortable:!0,format:t=>`${t.slice(0,40)} ...`}],ae=h(),j=t=>{t?Y.allPostsForAdmin(t.pagination.page,t==null?void 0:t.filter).then(p=>{var n,o,l,d,b,_;ae.value=p.data.posts,I.value.page=(l=(o=(n=p.data.meta)==null?void 0:n.pagination)==null?void 0:o.posts.current_page)!=null?l:1,I.value.rowsNumber=(_=(b=(d=p.data.meta)==null?void 0:d.pagination)==null?void 0:b.posts.total)!=null?_:1}):Y.allPostsForAdmin(1,t==null?void 0:t.filter).then(p=>{var n,o,l,d,b,_;ae.value=p.data.posts,I.value.page=(l=(o=(n=p.data.meta)==null?void 0:n.pagination)==null?void 0:o.posts.current_page)!=null?l:1,I.value.rowsNumber=(_=(b=(d=p.data.meta)==null?void 0:d.pagination)==null?void 0:b.posts.total)!=null?_:1})};j(null);const I=h({sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:100});function O(t,p,n,o){const l=[];return t.forEach(d=>{o(d)===!0?l.push(d):p.push({failedPropValidation:n,file:d})}),l}function G(t){t&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),ge(t)}const Oe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Be=["rejected"];function Ye({editable:t,dnd:p,getFileInput:n,addFilesToQueue:o}){const{props:l,emit:d,proxy:b}=ve(),_=h(null),v=F(()=>l.accept!==void 0?l.accept.split(",").map(s=>(s=s.trim(),s==="*"?"*/":(s.endsWith("/*")&&(s=s.slice(0,s.length-1)),s.toUpperCase()))):null),a=F(()=>parseInt(l.maxFiles,10)),i=F(()=>parseInt(l.maxTotalSize,10));function C(s){if(t.value)if(s!==Object(s)&&(s={target:null}),s.target!==null&&s.target.matches('input[type="file"]')===!0)s.clientX===0&&s.clientY===0&&Ce(s);else{const P=n();P&&P!==s.target&&P.click(s)}}function D(s){t.value&&s&&o(null,s)}function y(s,P,V,w){let c=Array.from(P||s.target.files);const k=[],T=()=>{k.length!==0&&d("rejected",k)};if(l.accept!==void 0&&v.value.indexOf("*/")===-1&&(c=O(c,k,"accept",g=>v.value.some(x=>g.type.toUpperCase().startsWith(x)||g.name.toUpperCase().endsWith(x))),c.length===0))return T();if(l.maxFileSize!==void 0){const g=parseInt(l.maxFileSize,10);if(c=O(c,k,"max-file-size",x=>x.size<=g),c.length===0)return T()}if(l.multiple!==!0&&c.length!==0&&(c=[c[0]]),c.forEach(g=>{g.__key=g.webkitRelativePath+g.lastModified+g.name+g.size}),w===!0){const g=V.map(x=>x.__key);c=O(c,k,"duplicate",x=>g.includes(x.__key)===!1)}if(c.length===0)return T();if(l.maxTotalSize!==void 0){let g=w===!0?V.reduce((x,ee)=>x+ee.size,0):0;if(c=O(c,k,"max-total-size",x=>(g+=x.size,g<=i.value)),c.length===0)return T()}if(typeof l.filter=="function"){const g=l.filter(c);c=O(c,k,"filter",x=>g.includes(x))}if(l.maxFiles!==void 0){let g=w===!0?V.length:0;if(c=O(c,k,"max-files",()=>(g++,g<=a.value)),c.length===0)return T()}if(T(),c.length!==0)return c}function m(s){G(s),p.value!==!0&&(p.value=!0)}function e(s){ge(s),(s.relatedTarget!==null||xe.is.safari!==!0?s.relatedTarget!==_.value:document.elementsFromPoint(s.clientX,s.clientY).includes(_.value)===!1)===!0&&(p.value=!1)}function q(s){G(s);const P=s.dataTransfer.files;P.length!==0&&o(null,P),p.value=!1}function U(s){if(p.value===!0)return R("div",{ref:_,class:`q-${s}__dnd absolute-full`,onDragenter:G,onDragover:G,onDragleave:e,onDrop:q})}return Object.assign(b,{pickFiles:C,addFiles:D}),{pickFiles:C,addFiles:D,onDragover:m,onDragleave:e,processFiles:y,getDndNode:U,maxFilesNumber:a,maxTotalSizeNumber:i}}var be=Se({name:"QFile",inheritAttrs:!1,props:{...qe,...ze,...Oe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ne,...Be],setup(t,{slots:p,emit:n,attrs:o}){const{proxy:l}=ve(),d=Qe(),b=h(null),_=h(!1),v=Ue(t),{pickFiles:a,onDragover:i,onDragleave:C,processFiles:D,getDndNode:y}=Ye({editable:d.editable,dnd:_,getFileInput:ie,addFilesToQueue:oe}),m=Ae(t),e=F(()=>Object(t.modelValue)===t.modelValue?"length"in t.modelValue?Array.from(t.modelValue):[t.modelValue]:[]),q=F(()=>me(e.value)),U=F(()=>e.value.map(f=>f.name).join(", ")),s=F(()=>ke(e.value.reduce((f,S)=>f+S.size,0))),P=F(()=>({totalSize:s.value,filesNumber:e.value.length,maxFiles:t.maxFiles})),V=F(()=>({tabindex:-1,type:"file",title:"",accept:t.accept,capture:t.capture,name:v.value,...o,id:d.targetUid.value,disabled:d.editable.value!==!0})),w=F(()=>"q-file q-field--auto-height"+(_.value===!0?" q-file--dnd":"")),c=F(()=>t.multiple===!0&&t.append===!0);function k(f){const S=e.value.slice();S.splice(f,1),g(S)}function T(f){const S=e.value.indexOf(f);S>-1&&k(S)}function g(f){n("update:modelValue",t.multiple===!0?f:f[0])}function x(f){f.keyCode===13&&Ve(f)}function ee(f){(f.keyCode===13||f.keyCode===32)&&a(f)}function ie(){return b.value}function oe(f,S){const z=D(f,S,e.value,c.value),te=ie();te!=null&&(te.value=""),z!==void 0&&((t.multiple===!0?t.modelValue&&z.every(Pe=>e.value.includes(Pe)):t.modelValue===z[0])||g(c.value===!0?e.value.concat(z):z))}function X(){return[R("input",{class:[t.inputClass,"q-file__filler"],style:t.inputStyle})]}function ye(){if(p.file!==void 0)return e.value.length===0?X():e.value.map((S,z)=>p.file({index:z,file:S,ref:this}));if(p.selected!==void 0)return e.value.length===0?X():p.selected({files:e.value,ref:this});if(t.useChips===!0)return e.value.length===0?X():e.value.map((S,z)=>R(Te,{key:"file-"+z,removable:d.editable.value,dense:!0,textColor:t.color,tabindex:t.tabindex,onRemove:()=>{k(z)}},()=>R("span",{class:"ellipsis",textContent:S.name})));const f=t.displayValue!==void 0?t.displayValue:U.value;return f.length!==0?[R("div",{class:t.inputClass,style:t.inputStyle,textContent:f})]:X()}function _e(){const f={ref:b,...V.value,...m.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:oe};return t.multiple===!0&&(f.multiple=!0),R("input",f)}return Object.assign(d,{fieldClass:w,emitValue:g,hasValue:q,inputRef:b,innerValue:e,floatingLabel:F(()=>q.value===!0||me(t.displayValue)),computedCounter:F(()=>{if(t.counterLabel!==void 0)return t.counterLabel(P.value);const f=t.maxFiles;return`${e.value.length}${f!==void 0?" / "+f:""} (${s.value})`}),getControlChild:()=>y("file"),getControl:()=>{const f={ref:d.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:t.tabindex};return d.editable.value===!0&&Object.assign(f,{onDragover:i,onDragleave:C,onKeydown:x,onKeyup:ee}),R("div",f,[_e()].concat(ye()))}}),Object.assign(l,{removeAtIndex:k,removeFile:T,getNativeElement:()=>b.value}),Fe(l,"nativeEl",()=>b.value),De(d)}});const je=$("div",{class:"text-h6"},"Create New Post",-1),Le=Z({__name:"AdminCreatePost",props:{modal:{default:!1},refresh:{}},emits:["update:modal"],setup(t,{emit:p}){const n=t,o=h(""),l=h(""),d=h(""),b=h(null),_=h(null),v=h(null),a=h({title:"",description:"",file:void 0}),i=p,C=()=>{i.call(this,"update:modal",!1)},D=()=>{Y.adminCreatePost(a.value.title,a.value.description,a.value.file).then(y=>{y.status==200&&(n.refresh(),i.call(this,"update:modal",!1))},y=>{var m,e,q,U,s,P,V,w,c;y.response.status!=200&&y.response.data.errors&&(o.value=(q=(e=(m=y.response.data.errors)==null?void 0:m.title)==null?void 0:e.toString())!=null?q:"",l.value=(P=(s=(U=y.response.data.errors)==null?void 0:U.description)==null?void 0:s.toString())!=null?P:"",d.value=(c=(w=(V=y.response.data.errors)==null?void 0:V.file)==null?void 0:w.toString())!=null?c:"",setTimeout(()=>{o.value="",l.value="",d.value=""},5e3))})};return(y,m)=>(N(),B(ne,{"model-value":n.modal,persistent:""},{default:u(()=>[r(se,{style:{"min-width":"350px"}},{default:u(()=>[r(Q,null,{default:u(()=>[je]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[r(W,{dense:"","model-value":a.value.title,"onUpdate:modelValue":m[0]||(m[0]=e=>a.value.title=e),label:"Enter Your Title",ref_key:"titleState",ref:b,error:o.value.length>0,"error-message":o.value,rules:[e=>!!e||"Required",e=>e.length>3||"Please use minimum 4 character",e=>e.length<=100||"Please use maximum 100 character"],"lazy-rules":""},null,8,["model-value","error","error-message","rules"])]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[r(W,{type:"textarea",dense:"","model-value":a.value.description,"onUpdate:modelValue":m[1]||(m[1]=e=>a.value.description=e),label:"Enter Your Description",ref_key:"descriptionState",ref:_,error:l.value.length>0,"error-message":l.value,rules:[e=>!!e||"Required",e=>e.length>3||"Please use minimum 4 character",e=>e.length<=1e4||"Please use maximum 10000 character"],"lazy-rules":""},null,8,["model-value","error","error-message","rules"])]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[r(be,{filled:"","bottom-slots":"","model-value":a.value.file,"onUpdate:modelValue":m[4]||(m[4]=e=>a.value.file=e),label:"Post Image",counter:"",ref_key:"imageState",ref:v,error:d.value.length>0,"error-message":d.value,rules:[e=>!!e||"Required"],"lazy-rules":""},{prepend:u(()=>[r(M,{name:"cloud_upload",onClick:m[2]||(m[2]=J(()=>{},["stop","prevent"]))})]),append:u(()=>[r(M,{name:"close",onClick:m[3]||(m[3]=J(e=>a.value.file=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:u(()=>[L(" File Size ")]),_:1},8,["model-value","error","error-message","rules"])]),_:1}),r(re,{align:"right",class:"text-primary"},{default:u(()=>[r(A,{color:"red","icon-right":"close",label:"Cancel",onClick:C}),r(A,{color:"light-blue-8","icon-right":"create",label:"Create",onClick:m[5]||(m[5]=e=>D())})]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),Ke=$("div",{class:"text-h6"},"Update Post",-1),Me=Z({__name:"AdminUpdatePost",props:{modal:{default:!1},data:{},refresh:{}},emits:["update:modal"],setup(t,{emit:p}){const n=t,o=h(""),l=h(""),d=h(""),b=h(null),_=h(null),v=h(null),a=h({id:0,title:"",description:"",file:void 0});he(n,()=>{a.value={id:n.data.id,title:n.data.title,description:n.data.description,file:a.value.file}});const i=p,C=()=>{i.call(this,"update:modal",!1)},D=()=>{Y.adminUpdatePost(a.value.id,a.value.title,a.value.description,a.value.file).then(y=>{y.status==200&&(n.refresh(),i.call(this,"update:modal",!1))},y=>{var m,e,q,U,s,P,V,w,c;y.response.status!=200&&y.response.data.errors&&(o.value=(q=(e=(m=y.response.data.errors)==null?void 0:m.title)==null?void 0:e.toString())!=null?q:"",l.value=(P=(s=(U=y.response.data.errors)==null?void 0:U.description)==null?void 0:s.toString())!=null?P:"",d.value=(c=(w=(V=y.response.data.errors)==null?void 0:V.file)==null?void 0:w.toString())!=null?c:"",setTimeout(()=>{o.value="",l.value="",d.value=""},5e3))})};return(y,m)=>(N(),B(ne,{"model-value":n.modal,persistent:""},{default:u(()=>[r(se,{style:{"min-width":"350px"}},{default:u(()=>[r(Q,null,{default:u(()=>[Ke]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[r(W,{dense:"","model-value":a.value.title,"onUpdate:modelValue":m[0]||(m[0]=e=>a.value.title=e),label:"Enter Your Title",ref_key:"titleState",ref:b,error:o.value.length>0,"error-message":o.value,rules:[e=>!!e||"Required",e=>e.length>3||"Please use minimum 4 character",e=>e.length<=100||"Please use maximum 100 character"],"lazy-rules":""},null,8,["model-value","error","error-message","rules"])]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[r(W,{type:"textarea",dense:"","model-value":a.value.description,"onUpdate:modelValue":m[1]||(m[1]=e=>a.value.description=e),label:"Enter Your Description",ref_key:"descriptionState",ref:_,error:l.value.length>0,"error-message":l.value,rules:[e=>!!e||"Required",e=>e.length>3||"Please use minimum 4 character",e=>e.length<=1e4||"Please use maximum 10000 character"],"lazy-rules":""},null,8,["model-value","error","error-message","rules"])]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[r(be,{filled:"","bottom-slots":"","model-value":a.value.file,"onUpdate:modelValue":m[4]||(m[4]=e=>a.value.file=e),label:"Post Image",counter:"",ref_key:"imageState",ref:v,error:d.value.length>0,"error-message":d.value},{prepend:u(()=>[r(M,{name:"cloud_upload",onClick:m[2]||(m[2]=J(()=>{},["stop","prevent"]))})]),append:u(()=>[r(M,{name:"close",onClick:m[3]||(m[3]=J(e=>a.value.file=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:u(()=>[L(" File Size ")]),_:1},8,["model-value","error","error-message"])]),_:1}),r(re,{align:"right",class:"text-primary"},{default:u(()=>[r(A,{color:"red","icon-right":"close",label:"Cancel",onClick:C}),r(A,{color:"light-blue-8","icon-right":"create",label:"Create",onClick:D})]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),We={key:1,width:"100%",height:"300px",controls:""},Xe=["src"],Ge={class:"row no-wrap items-center"},He={class:"col text-h6 ellipsis"},Je={class:"text-subtitle1"},Ze={class:"text-caption text-grey"},et=Z({__name:"AdminDeletePost",props:{modal:{default:!1},data:{},refresh:{}},emits:["update:modal"],setup(t,{emit:p}){const n=t,o=p,l=()=>{o.call(this,"update:modal",!1)},d=()=>{Y.adminDeletePost(n.data.id).then(v=>{v.status==200&&(n.refresh(),o.call(this,"update:modal",!1))},v=>{v.response.status!=200&&v.response.data.errors&&console.log(v.response.data.errors.error[0])})},b=h("");he(n.data,()=>{_(n.data.file,n.data.type)});const _=(v,a)=>{Y.getPostFile(v).then(i=>{b.value=`data:${a};base64,`+i})};return(v,a)=>(N(),B(ne,{"model-value":n.modal,persistent:""},{default:u(()=>[r(se,{style:{"min-width":"350px"}},{default:u(()=>[n.data.type.includes("image")?(N(),B($e,{key:0,src:b.value,fit:"cover",width:"100%",height:"300px"},null,8,["src"])):ue("",!0),n.data.type.includes("video")?(N(),H("video",We,[$("source",{src:b.value},null,8,Xe)])):ue("",!0),r(Q,null,{default:u(()=>[$("div",Ge,[$("div",He,K(n.data.title),1)])]),_:1}),r(Q,{class:"q-pt-none"},{default:u(()=>[$("div",Je,K(n.data.username),1),$("div",Ze,K(n.data.description.substring(0,200))+" ... ",1)]),_:1}),r(Ie),r(re,{align:"right"},{default:u(()=>[r(A,{color:"light-blue-8","icon-right":"close",label:"Cancel",onClick:l}),r(A,{color:"red","icon-right":"delete",label:"Remove",onClick:d})]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),tt={class:"q-pa-md q-mb-lg overflow-auto window-height"},dt=Z({__name:"AllPostPage",setup(t){const p=h(""),n=h({modal:!1}),o=h({modal:!1,id:0,title:"",description:""}),l=h({modal:!1,id:0,file:"",title:"",username:"",description:"",type:""}),d=()=>{n.value.modal=!n.value.modal},b=v=>{o.value.id=v.id,o.value.title=v.title,o.value.description=v.description,o.value.modal=!o.value.modal},_=v=>{l.value.id=v.id,l.value.file=v.media[0].id,l.value.title=v.title,l.value.username=v.admin.name,l.value.description=v.description,l.value.type=v.media[0].mime_type,l.value.modal=!l.value.modal};return(v,a)=>(N(),H(le,null,[$("div",tt,[r(Ee,{grid:v.$q.screen.xs,title:"All Posts",rows:E(ae),columns:E(Re),"row-key":"name",filter:p.value,"rows-per-page-options":[E(I).rowsPerPage],pagination:E(I),"onUpdate:pagination":a[2]||(a[2]=i=>we(I)?I.value=i:null),onRequest:E(j)},{"top-right":u(()=>[r(W,{class:"bg-white",borderless:"",dense:"",debounce:"300",modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=i=>p.value=i),placeholder:"Search"},{append:u(()=>[r(M,{name:"search"})]),_:1},8,["modelValue"]),r(A,{label:"Create New Post",color:"light-blue-8",class:"q-ml-md",onClick:a[1]||(a[1]=i=>d())})]),header:u(i=>[r(ce,{props:i},{default:u(()=>[(N(!0),H(le,null,de(i.cols,C=>(N(),B(fe,{key:C.name,props:i},{default:u(()=>[L(K(C.label),1)]),_:2},1032,["props"]))),128)),r(fe,{"auto-width":""},{default:u(()=>[L(" Tools ")]),_:1})]),_:2},1032,["props"])]),body:u(i=>[r(ce,{props:i},{default:u(()=>[(N(!0),H(le,null,de(i.cols,C=>(N(),B(pe,{key:C.name,props:i},{default:u(()=>[L(K(C.value),1)]),_:2},1032,["props"]))),128)),r(pe,{"auto-width":""},{default:u(()=>[r(A,{class:"q-ma-sm",size:"md",color:"warning",dense:"",icon:"update",onClick:C=>b(i.row)},null,8,["onClick"]),r(A,{class:"q-ma-sm",size:"md",color:"red",dense:"",icon:"delete",onClick:C=>_(i.row)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["grid","rows","columns","filter","rows-per-page-options","pagination","onRequest"])]),r(Le,{modal:n.value.modal,"onUpdate:modal":a[3]||(a[3]=i=>n.value.modal=i),refresh:E(j)},null,8,["modal","refresh"]),r(Me,{modal:o.value.modal,"onUpdate:modal":a[4]||(a[4]=i=>o.value.modal=i),data:o.value,"onUpdate:data":a[5]||(a[5]=i=>o.value=i),refresh:E(j)},null,8,["modal","data","refresh"]),r(et,{modal:l.value.modal,"onUpdate:modal":a[6]||(a[6]=i=>l.value.modal=i),data:l.value,"onUpdate:data":a[7]||(a[7]=i=>l.value=i),refresh:E(j)},null,8,["modal","data","refresh"])],64))}});export{dt as default};
